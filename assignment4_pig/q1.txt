register s3n://uw-cse-344-oregon.aws.amazon.com/myudfs.jar
raw = LOAD 's3n://uw-cse-344-oregon.aws.amazon.com/btc-2010-chunk-000' USING TextLoader as (line:chararray); 
ntriples = foreach raw generate FLATTEN(myudfs.RDFSplit3(line)) as (subject:chararray,predicate:chararray,object:chararray);
lobjects = group ntriples by (object) PARALLEL 50;
count_by_object = foreach objects generate flatten($0), COUNT($1) as count PARALLEL 50;

--order the resulting tuples by their count in descending order
count_by_object_ordered = order count_by_object by (count)  PARALLEL 50;

--- count records in count_by_object
count_records_all = group count_by_object ALL;
count_records =  foreach count_records_all generate count (count_by_object);



1.1 How many MapReduce jobs are generated by example.pig?
2 jobs - calc, and output?

1.2 How many reduce tasks are within the first MapReduce job? How many reduce tasks are within later MapReduce jobs
33 maps, 50 reduces
1 map, 1 reduce

1.3 How long does each job take? How long does the entire script take?

1.4 What is the schema of the tuples after each of the following commands in example.pig?

After the command ntriples = {subject: chararray,predicate: chararray,object: chararray}

After the command objects =  {group: chararray,ntriples: {(subject: chararray,predicate: chararray,object: chararray)}}
After the command count_by_object = count_by_object: {group: chararray,count: long}

Hint 1: Use the job tracker to see the number of map and reduce tasks for your MapReduce jobs.

Hint 2: To see the schema for intermediate results, you can use Pig's interactive command line client grunt, which you can launch by running Pig without specifying an input script on the command line. When using grunt, a command that you may want to know about is describe . To see a list of other commands, type help.

What you need to turn in:
How many records are there in count_by_object? 1622294
